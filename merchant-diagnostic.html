<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•†å®¶åå°è¯Šæ–­é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }
        .diagnostic-section {
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
        }
        .diagnostic-section h3 {
            margin: 0 0 15px 0;
            font-size: 18px;
        }
        .test-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
        }
        .test-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            font-family: monospace;
            font-size: 14px;
        }
        .success {
            background: rgba(76, 175, 80, 0.3);
            border: 1px solid rgba(76, 175, 80, 0.5);
        }
        .error {
            background: rgba(244, 67, 54, 0.3);
            border: 1px solid rgba(244, 67, 54, 0.5);
        }
        .warning {
            background: rgba(255, 152, 0, 0.3);
            border: 1px solid rgba(255, 152, 0, 0.5);
        }
        .info {
            background: rgba(33, 150, 243, 0.3);
            border: 1px solid rgba(33, 150, 243, 0.5);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” å•†å®¶åå°è¯Šæ–­å·¥å…·</h1>
        
        <div class="diagnostic-section">
            <h3>ğŸ“Š æœåŠ¡çŠ¶æ€æ£€æŸ¥</h3>
            <div id="serviceStatus" class="status info">æ­£åœ¨æ£€æŸ¥æœåŠ¡çŠ¶æ€...</div>
            <button class="test-button" onclick="checkServices()">ğŸ”„ é‡æ–°æ£€æŸ¥æœåŠ¡</button>
        </div>
        
        <div class="diagnostic-section">
            <h3>ğŸŒ ç½‘ç»œè¿æ¥æµ‹è¯•</h3>
            <div id="networkStatus" class="status info">æ­£åœ¨æµ‹è¯•ç½‘ç»œè¿æ¥...</div>
            <button class="test-button" onclick="testNetwork()">ğŸ”„ é‡æ–°æµ‹è¯•ç½‘ç»œ</button>
        </div>
        
        <div class="diagnostic-section">
            <h3>ğŸ“± é¡µé¢è®¿é—®æµ‹è¯•</h3>
            <a href="http://localhost:5174/merchant/" class="test-button" target="_blank">
                ğŸª å•†å®¶åå°ä¸»é¡µ
            </a>
            <a href="http://localhost:5174/merchant/mobile/dashboard" class="test-button" target="_blank">
                ğŸ“± ç§»åŠ¨ç«¯ä»ªè¡¨æ¿
            </a>
            <a href="http://localhost:5174/merchant/mobile/test" class="test-button" target="_blank">
                ğŸ§ª ç§»åŠ¨ç«¯æµ‹è¯•é¡µé¢
            </a>
        </div>
        
        <div class="diagnostic-section">
            <h3>ğŸ”§ å¼€å‘è€…å·¥å…·</h3>
            <div style="font-size: 14px; line-height: 1.6;">
                <strong>å¦‚æœé¡µé¢é»‘å±ï¼Œè¯·æ£€æŸ¥ï¼š</strong><br>
                1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)<br>
                2. æŸ¥çœ‹ Console æ ‡ç­¾é¡µæ˜¯å¦æœ‰é”™è¯¯<br>
                3. æŸ¥çœ‹ Network æ ‡ç­¾é¡µæ˜¯å¦æœ‰å¤±è´¥çš„è¯·æ±‚<br>
                4. æŸ¥çœ‹ Elements æ ‡ç­¾é¡µæ˜¯å¦æœ‰å†…å®¹åŠ è½½<br><br>
                
                <strong>å¸¸è§é—®é¢˜ï¼š</strong><br>
                â€¢ JavaScript é”™è¯¯å¯¼è‡´é¡µé¢æ— æ³•æ¸²æŸ“<br>
                â€¢ CSS æ ·å¼é—®é¢˜å¯¼è‡´å†…å®¹ä¸å¯è§<br>
                â€¢ ç½‘ç»œè¯·æ±‚å¤±è´¥<br>
                â€¢ æµè§ˆå™¨ç¼“å­˜é—®é¢˜
            </div>
        </div>
        
        <div class="diagnostic-section">
            <h3>ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ</h3>
            <button class="test-button" onclick="clearCache()">ğŸ—‘ï¸ æ¸…é™¤æµè§ˆå™¨ç¼“å­˜</button>
            <button class="test-button" onclick="hardRefresh()">ğŸ”„ å¼ºåˆ¶åˆ·æ–°é¡µé¢</button>
            <button class="test-button" onclick="restartServices()">ğŸ”„ é‡å¯æœåŠ¡</button>
        </div>
    </div>
    
    <script>
        // æ£€æŸ¥æœåŠ¡çŠ¶æ€
        async function checkServices() {
            const statusDiv = document.getElementById('serviceStatus');
            statusDiv.innerHTML = 'æ­£åœ¨æ£€æŸ¥æœåŠ¡çŠ¶æ€...';
            
            try {
                const response = await fetch('http://localhost:5174/merchant/');
                if (response.ok) {
                    statusDiv.innerHTML = 'âœ… å•†å®¶ç«¯æœåŠ¡æ­£å¸¸ (HTTP ' + response.status + ')';
                    statusDiv.className = 'status success';
                } else {
                    statusDiv.innerHTML = 'âŒ å•†å®¶ç«¯æœåŠ¡å¼‚å¸¸ (HTTP ' + response.status + ')';
                    statusDiv.className = 'status error';
                }
            } catch (error) {
                statusDiv.innerHTML = 'âŒ æ— æ³•è¿æ¥åˆ°å•†å®¶ç«¯æœåŠ¡: ' + error.message;
                statusDiv.className = 'status error';
            }
        }
        
        // æµ‹è¯•ç½‘ç»œè¿æ¥
        async function testNetwork() {
            const statusDiv = document.getElementById('networkStatus');
            statusDiv.innerHTML = 'æ­£åœ¨æµ‹è¯•ç½‘ç»œè¿æ¥...';
            
            const tests = [
                { name: 'å•†å®¶ç«¯', url: 'http://localhost:5174/merchant/' },
                { name: 'ç®¡ç†ç«¯', url: 'http://localhost:5175/admin/' },
                { name: 'ç”¨æˆ·ç«¯', url: 'http://localhost:3001/' },
                { name: 'API', url: 'http://localhost:3000/api/docs' }
            ];
            
            let results = [];
            
            for (const test of tests) {
                try {
                    const response = await fetch(test.url);
                    results.push(`${test.name}: ${response.ok ? 'âœ…' : 'âŒ'} (${response.status})`);
                } catch (error) {
                    results.push(`${test.name}: âŒ (è¿æ¥å¤±è´¥)`);
                }
            }
            
            statusDiv.innerHTML = results.join('<br>');
            statusDiv.className = 'status info';
        }
        
        // æ¸…é™¤ç¼“å­˜
        function clearCache() {
            if ('caches' in window) {
                caches.keys().then(function(names) {
                    names.forEach(function(name) {
                        caches.delete(name);
                    });
                });
            }
            alert('ç¼“å­˜å·²æ¸…é™¤ï¼Œè¯·åˆ·æ–°é¡µé¢');
        }
        
        // å¼ºåˆ¶åˆ·æ–°
        function hardRefresh() {
            window.location.reload(true);
        }
        
        // é‡å¯æœåŠ¡
        function restartServices() {
            alert('è¯·æ‰‹åŠ¨é‡å¯æœåŠ¡ï¼š\n1. åœæ­¢æœåŠ¡: pm2 stop all\n2. å¯åŠ¨æœåŠ¡: ./start-all.sh');
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥
        window.addEventListener('load', function() {
            checkServices();
            testNetwork();
        });
    </script>
</body>
</html>
