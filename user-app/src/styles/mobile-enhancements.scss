// 移动端增强样式 - 响应式设计和触屏体验优化

// 1. 触屏优化
.touch-optimized {
  // 增加触控目标大小
  min-height: 44px;
  min-width: 44px;
  
  // 移除点击高亮
  -webkit-tap-highlight-color: transparent;
  
  // 优化触控反馈
  &:active {
    transform: scale(0.98);
    transition: transform 0.1s ease;
  }
}

// 2. 滚动优化
.smooth-scroll {
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  
  // 隐藏滚动条但保持功能
  &::-webkit-scrollbar {
    display: none;
  }
  -ms-overflow-style: none;
  scrollbar-width: none;
}

// 3. 响应式断点
$mobile-xs: 360px;
$mobile-sm: 480px;
$mobile-md: 768px;
$tablet: 1024px;

// 4. 移动端专用样式
@media (max-width: $mobile-md) {
  // 全局移动端优化
  body {
    // 防止水平滚动
    overflow-x: hidden;
    
    // 优化字体渲染
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    
    // 禁用用户选择（除了输入框）
    user-select: none;
    
    input, textarea {
      user-select: text;
    }
  }
  
  // 按钮优化
  button, .btn, .el-button {
    @extend .touch-optimized;
    
    // 增加按钮间距
    margin: 4px;
    
    // 优化按钮样式
    border-radius: 8px;
    font-weight: 500;
    
    // 禁用双击缩放
    touch-action: manipulation;
  }
  
  // 输入框优化
  input, textarea, .el-input__inner {
    // 增加触控目标
    min-height: 44px;
    padding: 12px 16px;
    
    // 优化字体大小（防止iOS缩放）
    font-size: 16px;
    
    // 移除默认样式
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.1);
    color: #fff;
    
    &:focus {
      border-color: #ff0050;
      outline: none;
      box-shadow: 0 0 0 2px rgba(255, 0, 80, 0.2);
    }
  }
  
  // 卡片组件优化
  .card, .product-card, .mobile-product-card {
    // 增加触控反馈
    &:active {
      transform: scale(0.98);
      transition: transform 0.1s ease;
    }
    
    // 优化阴影
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);
    
    &:hover {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }
  }
  
  // 导航优化
  .nav, .navigation {
    // 固定导航栏
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    
    // 安全区域适配
    padding-bottom: env(safe-area-inset-bottom);
    
    // 背景模糊
    backdrop-filter: blur(20px);
    background: rgba(0, 0, 0, 0.9);
  }
  
  // 列表优化
  .list, .product-list {
    // 增加列表项间距
    .list-item {
      margin-bottom: 12px;
      padding: 16px;
      
      // 触控优化
      @extend .touch-optimized;
    }
  }
  
  // 图片优化
  img {
    // 防止图片被拖拽
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
    
    // 优化图片加载
    loading: lazy;
  }
  
  // 模态框优化
  .modal, .el-dialog {
    // 全屏模态框
    width: 100vw !important;
    height: 100vh !important;
    margin: 0 !important;
    border-radius: 0 !important;
    
    // 安全区域适配
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
  }
}

// 5. 小屏幕优化 (≤480px)
@media (max-width: $mobile-sm) {
  // 进一步减小间距
  .container, .content {
    padding: 8px;
  }
  
  // 优化字体大小
  h1 { font-size: 20px; }
  h2 { font-size: 18px; }
  h3 { font-size: 16px; }
  p { font-size: 14px; }
  
  // 优化按钮大小
  button, .btn {
    min-height: 48px;
    font-size: 16px;
  }
  
  // 优化输入框
  input, textarea {
    min-height: 48px;
    font-size: 16px;
  }
}

// 6. 超小屏幕优化 (≤360px)
@media (max-width: $mobile-xs) {
  // 最小化间距
  .container, .content {
    padding: 4px;
  }
  
  // 优化字体
  h1 { font-size: 18px; }
  h2 { font-size: 16px; }
  h3 { font-size: 14px; }
  p { font-size: 13px; }
  
  // 优化触控目标
  button, .btn {
    min-height: 44px;
    font-size: 14px;
  }
}

// 7. 横屏优化
@media (max-height: 500px) and (orientation: landscape) {
  // 减少垂直间距
  .mobile-header {
    height: 50px;
  }
  
  .mobile-home {
    padding-bottom: 50px;
  }
  
  // 优化导航栏
  .nav {
    height: 50px;
  }
}

// 8. 深色模式优化
@media (prefers-color-scheme: dark) {
  // 确保深色模式一致性
  body {
    background: #000;
    color: #fff;
  }
  
  // 优化对比度
  .text-muted {
    color: rgba(255, 255, 255, 0.6) !important;
  }
  
  .border {
    border-color: rgba(255, 255, 255, 0.2) !important;
  }
}

// 9. 高对比度模式
@media (prefers-contrast: high) {
  // 增加边框对比度
  button, input, .card {
    border-width: 2px;
    border-color: #fff;
  }
  
  // 优化文字对比度
  .text-muted {
    color: rgba(255, 255, 255, 0.8) !important;
  }
}

// 10. 减少动画模式
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

// 11. 触屏手势优化
.gesture-enabled {
  // 支持滑动手势
  touch-action: pan-x pan-y;
  
  // 优化滚动
  overscroll-behavior: contain;
}

// 12. 性能优化
.performance-optimized {
  // 启用硬件加速
  transform: translateZ(0);
  will-change: transform;
  
  // 优化重绘
  contain: layout style paint;
}

// 13. 加载状态优化
.loading-state {
  // 骨架屏动画
  background: linear-gradient(90deg, 
    rgba(255, 255, 255, 0.1) 25%, 
    rgba(255, 255, 255, 0.2) 50%, 
    rgba(255, 255, 255, 0.1) 75%
  );
  background-size: 200% 100%;
  animation: loading-shimmer 1.5s infinite;
}

@keyframes loading-shimmer {
  0% { background-position: -200% 0; }
  100% { background-position: 200% 0; }
}

// 14. 错误状态优化
.error-state {
  // 错误提示样式
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.3);
  color: #fca5a5;
  padding: 12px;
  border-radius: 8px;
  margin: 8px 0;
}

// 15. 成功状态优化
.success-state {
  // 成功提示样式
  background: rgba(34, 197, 94, 0.1);
  border: 1px solid rgba(34, 197, 94, 0.3);
  color: #86efac;
  padding: 12px;
  border-radius: 8px;
  margin: 8px 0;
}
